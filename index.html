<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermomètre de la Refrancisation à l'école</title>
     <link
      rel="Website Icon"
      type="png"
      href="data:image/png;base64,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"
    />
    <style>
        /* General Styles */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f8ff; /* Light Blue Background */
            color: #2c3e50; /* Dark Blue Text */
        }

        h1 {
            font-size: 2.2em;
            margin-top: 20px;
            color: #3498db; /* Blue Header */
            text-align: center; /* Center the title */
        }

        /* Content Container */
        .content-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Center content vertically */
            gap: 30px; /* Space between elements */
            min-height: 100vh; /* Ensure the container takes up full viewport height */
        }

        /* Response Count Styles */
        .response-count {
            font-size: 1.5em; /* Fixed font size for consistency */
            color: #16a085; /* Green Color */
        }

        /* Thermometer Styles */
        .thermometer-container {
            position: relative;
            width: 80px; /* Fixed width for thermometer */
            height: 500px; /* Fixed height for thermometer */
            background: linear-gradient(to bottom, #ecf0f1, #bdc3c7); /* Light Gray */
            border-radius: 30px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .thermometer-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, #e74c3c, #f39c12); /* Red to Yellow */
            border-radius: inherit; /* Match container's border-radius */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
            transition: height 0.5s ease-in-out;
        }

        .thermometer-label {
            font-size: 1.5em; /* Fixed font size for thermometer label */
            margin-top: 10px;
        }

        /* Graph Container */
        .graph-container {
            display: flex;
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            width: 90%; /* Use most of the available width */
            height: 700px; /* Larger height for the graph container */
            position: relative; /* Add position relative */
        }

        iframe {
            width: 100%; /* Full width of the graph container */
            height: 100%; /* Full height of the graph container */
            border-radius: 10px; /* Rounded corners for iframe */
            border: none; /* Remove border for a clean look */
        }

        /* Flag Styles */
        .flag-image {
            position: absolute; /* Position absolutely within the graph container */
            top: 10px; /* Adjust as needed */
            right: 10px; /* Adjust as needed */
            width: 500px; /* Adjust size as needed */
            height: auto;
        }

        footer {
            margin-top: auto; /* Push footer to the bottom if content is small */
            padding-bottom: 20px;
            font-size: 1em; /* Fixed font size for footer text */
            color: #777;
        }
    </style>
</head>
<body>
    <h1>Thermomètre de la Refrancisation à l'école</h1>

    <!-- Content Container -->
    <div class="content-container">
        <!-- Thermometer -->
        <div class="thermometer-container">
            <div class="thermometer-fill" id="thermometerFill" style="height: 0%;"></div>
        </div>
        <div class="thermometer-label" id="thermometerLabel">0%</div>

        <!-- Total Responses Count -->
        <div class="response-count" id="responseCount">Réponses totales : --</div>

        <!-- Google Sheets Graph -->
        <div class="graph-container">
           <!-- Embedded Google Sheets chart -->
           <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRtZ_71m1Meyy9THPbcnVJ9AVYZm9T6R0FRtDA92hKHv_klruPO-1lJb9TXSWxITQo5oS0ZD2YYzFf2/pubchart?oid=1597539294&amp;format=interactive"></iframe>
           <img src="franco.png" alt="Franco-Ontarian Flag" class="flag-image"> <!-- Flag image -->
        </div>
    </div>

    <footer>&copy; Thermomètre Interactif - Tous droits réservés</footer>

    <script>
        // Fetch thermometer data from Firebase and update the thermometer
        async function fetchDataAndUpdateThermometer() {
            try {
                const response = await fetch('https://refrancisation-default-rtdb.firebaseio.com/niveau.json'); // Firebase Realtime Database URL
                const niveau = await response.json(); // Parse JSON response

                updateThermometer(niveau);
                updateResponseCount(niveau);

                console.log("Fetched data:", niveau); // Debugging log
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById('thermometerLabel').textContent = "Erreur de chargement des données !";
                document.getElementById('thermometerFill').style.height = "0%";
                document.getElementById('responseCount').textContent = "Réponses totales : Erreur";
            }
        }

        function updateThermometer(niveau) {
            const moyenne = typeof niveau.moyenne === "object"
                ? Number(niveau.moyenne.value)
                : Number(niveau.moyenne);

            const thermometerFill = document.getElementById('thermometerFill');
            const thermometerLabel = document.getElementById('thermometerLabel');

            if (!isNaN(moyenne)) {
                const percentage = Math.min((moyenne / 100) * 100, 100);
                thermometerFill.style.height = percentage + "%";
                thermometerLabel.textContent = moyenne.toFixed(1) + "%";

                console.log("Updated thermometer to:", percentage + "%");
            } else {
                console.error("Invalid moyenne value:", niveau.moyenne);
                thermometerFill.style.height = "0%";
                document.getElementById('thermometerLabel').textContent = "Données invalides";
            }
        }

        function updateResponseCount(niveau) {
            const totalResponses = typeof niveau.totalResponses === "object"
                ? Number(niveau.totalResponses.value)
                : Number(niveau.totalResponses);

            const responseCountElement = document.getElementById('responseCount');

            if (!isNaN(totalResponses)) {
                responseCountElement.textContent = `Réponses totales : ${totalResponses}`;
                console.log("Updated total responses to:", totalResponses);
            } else {
                console.error("Invalid totalResponses value:", niveau.totalResponses);
                responseCountElement.textContent = "Réponses totales : Données invalides";
            }
        }

        // Fetch thermometer data every ~1.5 seconds
        setInterval(fetchDataAndUpdateThermometer, 1500);

        // Initial fetch
        fetchDataAndUpdateThermometer();
    </script>
</body>
</html>
